# Подключение к вашему боту CDN Gcore
## Ограничения по установке

 - У вас должна быть **возможность редактировать DNS записи вашего домена**
   (не подойдут различные сервисы freedns и сервисы привязки домена к ip
   (sslip.io, nip.io и другие))
 - У вашего бота в разделе XRAY **должен быть включен режим Websocket**
   (Reality не совместимо с CDN)
 - На бесплатном тарифе Gcore **вы сможете проксировать только 1TB данных**
 - **Не возможно проксировать через GCore VPS в режиме IPv6-only**

## Регистрация на портале Gcore
Переходим на [портал Gcore](https://auth.gcore.com/login/signup) и выполняем регистрацию на бесплатном тарифе.
## Создание поддомена для CDN Gcore
Перед настройкой CDN
Вам требуется создать A запись для вашего поддомена (**не должно совпадать с поддоменами вашего vpnbot**, а так-же можно использовать вообще другой домен) c привязкой к вашему ip адресу VPS
## Настройка CDN
После регистрации **переходите в раздел CDN** и нажимайте кнопку **Создать ресурс CDN**
В открывшемся окне Тип ускорения и защиты выбирайте пункт **Ускорить и защитить весь сайт** и нажимайте далее
Затем указываем домен который у вас будет использоваться для проксирования через CDN (созданный в разделе Создание поддомена)
В открывшемся окне DNS-записи удаляем все записи, которые у вас будут показаны.
После этого вам откроется окно создание DNS записи
В пункте тип выбираем A - IPv4
В разделе IPv4 адрес указываем IPv4 адрес вашего VPS и нажимаем добавить:
Затем нажимаем кнопку Подтвердить
В появившемся окне Замените серверы имён ничего не делает просто пропускаем и нажимаем Подтвердить
В появившемся окне CDN-ресурс успешно создан нажимаем Открыть настройки ресурса
В настройках ресурса в разделе Протокол взаимодействия с источником выбираем HTTPS, а затем нажимаем кнопку Сохранить изменения.
После сохранения нажмите кнопку Редактировать группу в разделе Протокол взаимодействия с источником:
В открывшемся окне в разделе Источник контента укажите корневой домен вашего экземпляра vpnbot (без np oc или clientID adguard) и нажмите кнопку Сохранить изменения
В разделе Кеширование у пункта Кеширование на CDN переводим в положение выключить:
В разделе Доступы у пункта Имя SNI-хоста включаем пункт Измения имя SNI-хоста с параметром Динамическое имя SNI-хоста
В разделе Контент у пункта WebSockets переводим в положение включить
ОПЦИОНАЛЬНО в разделе Сетевые ограничения в пункте Скорость загрузки можно задать ограничения по скорости:

Затем на нижней панели нажимаем кнопку Сохранить изменения
## Привязка CDN к вашему DNS 
Переходим в раздел Managed DNS и переходим на страницу управления вашим доменом:
У dns записи вашего CDN нажимаем кнопку изменить (✏️), а затем нажимаем кнопку Интеграция с CDN:
В появившемся окошке вы увидите домен интеграции с CDN, вам требуется его скопировать в буфер обмена
Возвращаемся в панель управления записями вашего домена и изменяем ранее созданный поддомен (меняем тип с A на CNAME, а вместо ip-адреса vps указываем домен интеграции c CDN)
## Чайная пауза
После привязки CDN требуется подождать интеграции 10-15 минут.
Убедится что интеграция произошла можно на порте check-host - указав ваш cdn домен вы увидите айпи адрес и провайдера Gcore:
## Финальные настройки и проверка
Снова возвращаемся в раздел CDN выбираем созданный ресурс CDN, в разделе общие переходим к пункту SSL переводим в положение включить пункт Поддержка HTTPS нажимаем кнопку Получить SSL-сертификат ожидаем получения сертификата и сохраняем изменения:
![image](https://github.com/user-attachments/assets/3fdc8162-6797-4283-8c3c-44437f5acaca)
Проверяем соединение в используемых вами прокси-клиентах:
