# Подключение к вашему боту CDN Gcore
## Ограничения по установке

 - У вас должна быть **возможность редактировать DNS записи вашего домена**
   (не подойдут различные сервисы freedns и сервисы привязки домена к ip
   (sslip.io, nip.io и другие))
 - У вашего бота в разделе XRAY **должен быть включен режим Websocket**
   (Reality не совместимо с CDN)
 - На бесплатном тарифе Gcore **вы сможете проксировать только 1TB данных**

## Регистрация на портале Gcore
Переходим на [портал Gcore](https://auth.gcore.com/login/signup) и выполняем регистрацию на бесплатном тарифе.
## Создание поддомена для CDN Gcore
Перед настройкой CDN
Вам требуется создать A запись для вашего поддомена (**не должно совпадать с поддоменами вашего vpnbot**, а так-же можно использовать вообще другой домен) c привязкой к вашему ip адресу VPS
![image](https://github.com/user-attachments/assets/9e9af618-ccc4-490d-93ba-4c1e6f2101d4)
## Настройка CDN
После регистрации **переходите в раздел CDN** и нажимайте кнопку **Создать ресурс CDN**
![image](https://github.com/user-attachments/assets/4c6d88a3-63b9-435a-a060-36a0a6456d5e)
В открывшемся окне Тип ускорения и защиты выбирайте пункт **Ускорить и защитить весь сайт** и нажимайте далее
![image](https://github.com/user-attachments/assets/bb477ae4-fe0f-45d2-90e0-df80bcc80dd7) 

Затем указываем домен который у вас будет использоваться для проксирования через CDN (созданный в разделе Создание поддомена)
![image](https://github.com/user-attachments/assets/38758094-ab32-46f2-833f-92551f867145)
В открывшемся окне DNS-записи удаляем все записи, которые у вас будут показаны.
![image](https://github.com/user-attachments/assets/166551dd-3b0c-4ea4-ba63-5e9905572117)
После этого вам откроется окно создание DNS записи
В пункте тип выбираем A - IPv4
В разделе IPv4 адрес указываем IPv4 адрес вашего VPS и нажимаем добавить:
![image](https://github.com/user-attachments/assets/0a8d437d-49d2-47ae-8622-feb2a744be19)
Затем нажимаем кнопку Подтвердить
![image](https://github.com/user-attachments/assets/832742bc-36d5-4f2a-9886-221854e63737)
В появившемся окне Замените серверы имён ничего не делает просто пропускаем и нажимаем Подтвердить
![image](https://github.com/user-attachments/assets/a8c046d4-0e0d-4cc7-a755-425eb9c36f69)
В появившемся окне CDN-ресурс успешно создан нажимаем Открыть настройки ресурса
![image](https://github.com/user-attachments/assets/dc938eef-32bb-445e-86cf-f20d32086cb2)
В настройках ресурса в разделе Протокол взаимодействия с источником выбираем HTTPS, а затем нажимаем кнопку Сохранить изменения.
После сохранения нажмите кнопку Редактировать группу в разделе Протокол взаимодействия с источником:
![image](https://github.com/user-attachments/assets/3a65467b-e714-479b-afec-8cfd2f6b1ae6)
В открывшемся окне в разделе Источник контента укажите корневой домен вашего экземпляра vpnbot (без np oc или clientID adguard) и нажмите кнопку Сохранить изменения
![image](https://github.com/user-attachments/assets/c460e939-1880-4382-926a-579f050d7a3f)
В разделе Кеширование у пункта Кеширование на CDN переводим в положение выключить:
![image](https://github.com/user-attachments/assets/4b198ede-b617-492f-b9e6-40ff87989f31)
В разделе Доступы у пункта Имя SNI-хоста включаем пункт Измения имя SNI-хоста с параметром Динамическое имя SNI-хоста
![image](https://github.com/user-attachments/assets/64c4a90a-0713-45c5-b617-d8cbff56727d)
В разделе Контент у пункта WebSockets переводим в положение включить
![image](https://github.com/user-attachments/assets/25e8e1f2-2851-4764-a3e1-8ec9617820c2)
ОПЦИОНАЛЬНО в разделе Сетевые ограничения в пункте Скорость загрузки можно задать ограничения по скорости:
![image](https://github.com/user-attachments/assets/8af17604-3eb5-4a34-9363-744356db4599)
Затем на нижней панели нажимаем кнопку Сохранить изменения
## Привязка CDN к вашему DNS 
Переходим в раздел Managed DNS и переходим на страницу управления вашим доменом:
![image](https://github.com/user-attachments/assets/30f3cb5b-c861-41e3-b631-091f9f733ce2)
У dns записи вашего CDN нажимаем кнопку изменить (✏️), а затем нажимаем кнопку Интеграция с CDN:
![image](https://github.com/user-attachments/assets/4e5592ac-ecfb-495f-8f0f-3abf1a2bd679)
В появившемся окошке вы увидите домен интеграции с CDN, вам требуется его скопировать в буфер обмена
![image](https://github.com/user-attachments/assets/b339bc8a-7af0-432c-aac3-f1b7fb22f127)
Возвращаемся в панель управления записями вашего домена и изменяем ранее созданный поддомен (меняем тип с A на CNAME, а вместо ip-адреса vps указываем домен интеграции c CDN)
![image](https://github.com/user-attachments/assets/e767e8be-cb16-46e1-856e-d645e66e0603)
## Чайная пауза
После привязки CDN требуется подождать интеграции 10-15 минут.
Убедится что интеграция произошла можно на порте [check-host](https://check-host.net/ip-info) - указав ваш cdn домен вы увидите айпи адрес и провайдера Gcore:
![image](https://github.com/user-attachments/assets/183382d0-cb1b-441d-b3c5-adc3d6efeeb3)
## Финальные настройки и проверка
Снова возвращаемся в раздел CDN выбираем созданный ресурс CDN, в разделе общие переходим к пункту SSL переводим в положение включить пункт Поддержка HTTPS нажимаем кнопку Получить SSL-сертификат ожидаем получения сертификата и сохраняем изменения:
![image](https://github.com/user-attachments/assets/3fdc8162-6797-4283-8c3c-44437f5acaca)
![image](https://github.com/user-attachments/assets/ba8ed2cc-5aea-4f17-a9e0-1486c28fa30c)

Проверяем соединение в используемых вами прокси-клиентах:
